\documentclass{physor2012}
%
%  various packages that you may wish to activate for usage 
%\usepackage{tabls}
\usepackage{cites}
\usepackage{epsf}
%\usepackage{appendix}
%
% Define title...
%
\title{GENERATING NUCLIDE-SPECIFIC SCATTERING KERNELS WITH SERPENT}
%
% ...and authors
%
\author{%
  % FIRST AUTHORS 
  %
  \textbf{Anthony Scopatz and Erich Schneider} \\
  The University of Texas at Austin \\
  1 University Station, C2200, Austin, TX, 78712 \\
  \url{scopatz@mail.utexas.edu}; \url{eschneider@mail.utexas.edu} \\
}
%
% Insert authors' names and short version of title in lines below
%
\newcommand{\authorHead}      % Author's names here
           {A. M. Scopatz and E. A. Schneider}  
\newcommand{\shortTitle}      % Short title here
           {Gneerating Nuclide-Specific Scattering Kernels with Serpent}


%General Short-Cut Commands
\newcommand{\superscript}[1]{\ensuremath{^{\textrm{#1}}}}
\newcommand{\subscript}[1]{\ensuremath{_{\textrm{#1}}}}
\newcommand{\nuc}[2]{\superscript{#2}{#1}}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%   BEGIN DOCUMENT
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
\maketitle
\begin{abstract}
  Use 8.5$\times$11 paper size, with 1'' margins on all sides.  A required 200-250 
  word abstract starts on this line.  Leave two blank lines before ``ABSTRACT''
  and one after.  Use 10 point Times New Roman here and single 
  spacing. The abstract is a very brief summary highlighting main 
  accomplishments, what is new, and how it relates to the state-of-the-art.
\end{abstract}
\keywords{List of at most five key words}


\section{INTRODUCTION} 
Creating full-core, homogenized neutron group-to-group scattering cross sections
for nuclear power reactors is traditionally done via Monte Carlo methods (such as
MCNPX \cite{}).  Computing region or sub-region kernels may be performed in much 
the same way.  However, these methods homogenize not only over reactor geometry
but over material composisition as well.  For perturbation-based reactor models 
\cite{}, nuclide specific scattering cross sections are needed.

Perturbation-based reactor models (such as those in Bright \cite{}) use a 
set of precomputed libraries (such as those generated by Char \cite{}).
These libraries are comprised of microscopic neutron cross sections 
or reaction rates for each nuclide for a given reactor state.  For reactor 
specifications that are not one of the precomputed states, two or more libraries
are interpolated at run-time to form a dynamically generated core.  This mechanism
grants large performance gains over transport methods while maintatining 
acceptable core performance fidelity.

For multi-energy group reactor models using the above algorithm, the scattering 
cross section $\sigma_{s,g\to h,i}$ [barns] is needed to be able to perform 
consistent interpolations. (Here, the subscript $s$ denotes the scattering channel, 
the subscripts $g$ \& $h$ index $G$ incident and exiting energies, and the subscript
$i$ indexes $I$ species.)  This parameter is notbaly more important in thermal reactors
than fast cores.  Furthermore, previous single energy group studies \cite{} did 
not require the group-to-group scattering cross section at all because both 
$g$ \& $h$ are intergated over.

While most Monte Carlo neutron transport codes may compute few group cross
sections (\emph{i.e.} $\sigma_{s,g,i}$), most fail to expose the distribution
of neutron exiting energies after a reaction ($\sigma_{s,g\to h,i}$).  Those
codes which do report exiting energies display only the sum over all consitiuent 
materials in the region of interest ($\sigma_{s,g\to h}$).  Thus obtaining 
the parameters for a perturbation-based reactor model is itself a challenge.

In the initial scoping of library generation (Char) two burnup-coupled transport 
codes were considered: MCNPX (v2.6+) and Serpent (v1.7+).  MCNPX confers the 
ability to compute $\sigma_{s,g,i}$.  Serpent by default will calculate 
$\sigma_{s,g\to h}$ and allows the user to compute $\sigma_{s,g,i}$ as well.

Becuase the group-to-group scattering cross section was already natively supported, 
Serpent was ultimately chosen to statisfy the group constant generation needs of
Char.  However, the source code of Serpent needed to be altered to support 
the reporting of $\sigma_{s,g\to h,i}$.  This modified verion is available upon
request from the author\footnote{This is subject to the same license and restrictions
as Serpent itself.}.

The success of the perturbation-based multigroup model itself serves to validate
the modifications made to Serpent.  However, this study presents a sensitivity study 
which focuses on the group-to-gorup scattering cross section as calculated via 
the modified Serpent.  Here the fuel pin radius set to two different values and 
$\sigma_{s,g\to h,i}$ is calculated for all nuclides.  Values for the scattering 
kernel for intermediate fuel radii were then found via interpolation and modified Serpent 
and compared.  Additionally full-core and region group constants were also compared.

In \S \ref{sec:methodology} is an explantion of the modifications made to Serpent 
and the detailing of the sensitivity study performed.  In \S \ref{sec:results} the 
reults of the sensitivity study are presented.  Lastly, \S \ref{sec:conclusions}
discusses concluding remarks and potential future work.

\section{METHODOLOGY} 
\label{sec:methodology}

This work is composed of two main parts.  The first portion describes how 
Serpent was altered to generate nuclide specific scattering kernels.  
The second portion outlines a fuel radius perturbation study used to 
validate the changes made to the Serpent code base.

\subsection{Serpent Modifications}

The reactor physics code Serpent calculates group transfer probabilities and 
group-to-group scattering cross sections for user-specified geometries and energy 
group structures as part of its standard suite of results.   Call $P_{g\to h}$  
the group transfer probability.  To within computational error, the following 
relations are true:

\begin{equation}\label{P_h_norm}\sum_h^G P_{g\to h} = \mathbf{\vec{1}}\end{equation}
\begin{equation}\label{P_sig_norm}P_{g\to h} = \frac{\sigma_{s,g\to h}}{\sigma_{s,g}}\end{equation}

Serpent, like other physics codes, allows users to specify materials.
Denote $m_i$ as the mass fraction of the $i$\superscript{th} nuclide 
in a material.  The scattering cross section of the material is thus
the weighted sum of the constituent species:
\begin{equation}\label{mat_norm}\sigma_{s,g\to h} = \sum_i^I m_i \cdot \sigma_{s,g\to h,i}\end{equation}

By combining equations \ref{P_sig_norm} \& \ref{mat_norm}, an expression for the
group transfer probability is obtained which represents the method by which it
is calculated within Serpent.
\begin{equation}
\label{P_serp}
P_{g\to h} = \frac{\sum_i^I m_i \cdot \sigma_{s,g\to h,i}}{\sigma_{s,g}} = \sum_i^I m_i \cdot P_{g\to h,i}
\end{equation}
The desired parameter, either $\sigma_{s,g\to h,i}$ or $P_{g\to h,i}$, lies within
the summation in equation \ref{P_serp}.

Therefore to obtain nuclide-specific scattering kernels Serpernt must be prevented
from executing the above summation for all but the desired species.  Hence, the 
appropriate loop was found and a material filter was added.  As a Monte Carlo code, 
this filter would only be triggered if a scattering reaction occured.  Thus the
addition of this filter did not adversely affect other tallies.  Moreoever, this
filter was included after all physics calculations but prior to reporting.  The 
physics of the reactor was not altered by the use of the filter.

The implementation of the filter works as follows. First,the user specifies
a dummy filter material.  The nuclides present in this material are the species 
which are tallied by the filter.  All other nuclides are ignored, as are the mass 
fraction values.  Then the user sets the material to filter via the new `gtpmat'
option.  This has the syntax `set gtpmat $<$material label$>$'.

Serpent normally outputs the group transfer probability and the group-to-group
scattering cross section to the GTRANSFP and GTRANSFXS variables respectively.
Howver by using `gtpmat', GTRANSFP takes on the filtered value while GTRANSFXS
is invalidated.  The loss of meaning for GTRANSFXS here is not problematic
because, using the detector capability of Serpent, $\sigma_{s,g,i}$ may computed.
This can then be convolved with the newly computed $P_{g\to h,i}$ to obtain
the correct $\sigma_{s,g\to h,i}$.

Since the filter nuclides are given as a set (albeit as members of a material), 
isotope-specific group transfer probabilities are obtained using materials with 
only a single species.  This is the most common usage of the additional `gtpmat'
command.

\subsection{Kernel Interpolations}

The primary purpose of storing sets of multigroup cross sections is 
to be able to interpolate between them.  Since interpolations of existsing 
data is orders of magnitude faster than computing new values via neutron 
transport methods, this allows a perturbation-based reactor model to have
run-time, reactor-state-specific group constants.  Such a model has been
demonstrated \cite{}.  While $\sigma_{s,g,i}$ was explicitly 
verified, the validity of interpolating the group-to-group scattering
cross section was only checked via its aggregation.  Here, interpolations on
$\sigma_{s,g\to h,i}$ are tested explictly.

The state of the reactor and coorespeonding experimental variables are taken
to be the same as in \cite{}.  Neutron energies were discretized into a 19-group
stracture desinged to more finely capture the epithermal region.  Call $E$ [MeV]
a neutron energy. Then $E_g$ [MeV] denotes the energy group boundries.
These are displayed in Table \ref{group_boundaries}.

\begin{table}[htbp]
\begin{center}
\caption{Energy Group Boundaries $E_g$}
\label{group_boundaries}
\begin{tabular}{|c|c||c|c|}
\hline
\textbf{$g$} & \textbf{$E_g$ [MeV]} & \textbf{$g$} & \textbf{$E_g$ [MeV]} \\
\hline
1  & 10      & 11 & 2.15E-5 \\ 
2  & 1       & 12 & 1.29E-5 \\ 
3  & 0.1     & 13 & 7.74E-6 \\
4  & 0.01    & 14 & 4.64E-6 \\
5  & 3.16E-3 & 15 & 2.78E-6 \\
6  & 1.00E-3 & 16 & 1.67E-6 \\
7  & 3.16E-4 & 17 & 1.00E-6 \\
8  & 1.00E-4 & 18 & 1.00E-7 \\
9  & 5.99E-5 & 19 & 1.00E-8 \\
10 & 3.59E-5 & 20 & 1.00E-9 \\
\hline
\end{tabular}
\end{center}
\end{table}

The core considered here was a standard light-water reactor (LWR) taken from an
OECD/NEA Burnup Credit Criticality report \cite{}.  The reactor was modeled as
an infinite lattice of fuel pin cells.  The benchmark (unperturbed) state of the 
reactor may be seen in Table \ref{}.


\section{RESULTS} 
\label{sec:results}


%
\section{CONCLUSIONS \& FUTURE WORK}
\ref{sec:conclusions}
%
Present your summary and conclusions here.
%
\section*{ACKNOWLEDGEMENTS}
%
Acknowledge the help of colleagues and sources of funding, as appropriate.
%
The format for this template was adapted from the template for Math and Computation 2009 
posted on the Internet.  Most of the \LaTeX\ format definitions contained
in this and the accompanying files were adapted from sample files supplied 
by J. Wagner (ORNL) and James Warsa (LANL). Their help is greatly appreciated.

%
\setlength{\baselineskip}{12pt}
\bibliographystyle{physor}
\bibliography{library}

\end{document}

